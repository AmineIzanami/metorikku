steps:
- dataFrameName: moviesWithRatings
  sql:
    SELECT userid,
           movies.movieid as movieId,
           rating,
           timestamp,
           title,
           genres,
           now() as ts,
           concat("year=",year(from_unixtime(timestamp)),"/month=", month(from_unixtime(timestamp))) as partition
    FROM ratings
    JOIN movies ON ratings.movieid = movies.movieid
    WHERE year(from_unixtime(timestamp))='2014'
output:
- dataFrameName: moviesWithRatings
  outputType: Hudi
  outputOptions:
    saveMode: Append
    path: topFantasyMovies.parquet
#- dataFrameName: topFantasyMovies
#  outputType: CSV
#  outputOptions:
#    saveMode: Overwrite
#    path: topFantasyMovies.csv
#    coalesce: true
#    extraOptions:
#      multiline: "true"
#- dataFrameName: topFantasyMovies
#  outputType: JSON
#  outputOptions:
#    saveMode: Overwrite
#    path: topFantasyMovies.jsonl
#    repartition: 10
